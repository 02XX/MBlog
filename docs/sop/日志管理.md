---
title: 日志管理
tags: []
categories:
  - [未分类]
date: 2023-04-04T00:49:29.000Z
updated: 2024-10-14T13:56:26.531Z
comments: false

---

<!--more-->
# 日志管理

## 常见日志

![常见日志](E:\markdown\图床\常见日志.png)

![常见日志2](E:\markdown\图床\常见日志2.png)

**源码包安装的日志是在指定目录中，rpm包安装的在/var/log中**

## rsyslogd日志

### 格式

```bash
时间	产生事件的服务器主机名	产生时间的服务名或程序名	事件的具体信息
Sep 29 23:12:04 izbp1clp96b0qjo5whikc9z sshd[4630]: Failed password for invalid user admin from 80.11.39.203 port 31491 ssh2
```

### rsyslogd的配置文件

`/etc/rsyslog.conf`

```bash
服务名称[连接服务]日志等级				日志记录位置
cron.*                                 /var/log/cron
```

![日志配置文件服务名称](E:\markdown\图床\日志配置文件服务名称.png)

![日志配置文件服务名称2](E:\markdown\图床\日志配置文件服务名称2.png)

### 连接符号

`*	.	.=	.!`	
![连接符号](E:\markdown\图床\连接符号.png)

### 日志等级
![日志等级](E:\markdown\图床\日志等级.png)

### 日志记录位置

1. 日志文件的绝对路径
2. 系统设备文件
3. 转发给远程主机
4. 用户名，发给某个用户
5. 忽略或丢掉日志

## 日志轮替

轮替包含日志切割和旧日志删除

### 日志命名

1. 如果logrotate配置文件中拥有“dateext”参数，那么日志会用日期来作为日志文件的后缀，例如“secure-20130605”。这样的话日志文件名不会重叠，所以也就不需要日志文件的改名，只需要保存指定的日志个数，删除多余的日志文件即可。
2. 如果配置文件中没有“dateext”参数，那么日志文件就需要进行改名了。当第一次进行日志轮替时，当前的“secure”日志会自动改名为
   “secure.1”，然后新建“secure”日志，用来保存新的日志。当第二次进行日志轮替时，“secure.1”会自动改名为“secure.2”，当前的“secure”日志会自动改名为“secure.1”，然后也会新建“secure”日志，用来保存新的日志，以此类推。

### logrotate配置文件

![logrotate配置文件](E:\markdown\图床\logrotate配置文件.png)

![logrotate配置文件2](E:\markdown\图床\logrotate配置文件2.png)

`/etc/logrotate.conf`

### 加入轮替

```bash
/usr/local/apache2/logs/access_log{
daily
create
rotate 30
}
```

```bash
logrotate [option] [配置文件名]
		 -v：显示日志轮替过程
		 -f：强制进行日志轮替，不管日志轮替条件是什么
```