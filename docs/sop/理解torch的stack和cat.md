---
title: 理解torch的stack和cat
tags:
  - DeepLearning
categories:
  - [DeepLearning]
date: 2024-10-14T11:47:45.301Z
updated: 2024-10-14T13:56:42.472Z
comments: true

---

<!--more-->
## 两个tensor

```python
a = tensor([[1,2,3,4],[5,6,7,8],[9,10,11,12]]) # 3x4
b = tensor([[11,22,33,44], [55,66,77,88], [99,1010,1111,1212]]) #3x4
```

可以将维度理解为方括号，维度0代表最外层方括号， stack保留方括号的两壁并新建一个两壁，cat消除连接处的壁，保留另一侧的壁

## torch.stack

stack保留方括号的两壁并新建一个两壁，为了突出新建的括号用{}表示

```python
stack((a,b),dim=0)
```

dim=0

```python
{  [[1,2,3,4],[5,6,7,8],[9,10,11,12]] , [[11,22,33,44], [55,66,77,88], [99,1010,1111,1212]]    } #2x3x4
```

dim=1

```python
[{[1,2,3,4],[11,22,33,44]},{[5,6,7,8],[55,66,77,88]},{[9,10,11,12],[99,1010,1111,1212]}] #3x2x4
```

## torch.cat

cat消除连接处的壁，保留另一侧的壁，为了突出消除的壁用 | 表示

dim=0

```python
python
[[1,2,3,4],[5,6,7,8],[9,10,11,12] || [11,22,33,44],[55,66,77,88],[99,1010,1111,1212]] #6x4
```

dim=1

```python
[[1,2,3,4 || 11,22,33,44],[5,6,7,8 || 55,66,77,88],[9,10,11,12,99 || 1010,1111,1212]]#3x8
```